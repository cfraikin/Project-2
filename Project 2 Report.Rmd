---
title: "Project 2 Report"
author: "Chanel Fraikin and Benjamin Kelly"
output: html_document
---

# Global Trajectory
```{r obj1}

library(knitr)
library(kableExtra)
library(magrittr)
library(readr)
library(geosphere)
library(dplyr)
library(tidyr)
library(ggplot2)

confirmed_ds<-read.csv("time_series_covid19_confirmed_global.csv", 
                       header=TRUE, stringsAsFactors=FALSE)
deaths_ds<-read.csv("time_series_covid19_deaths_global.csv", 
                    header=TRUE, stringsAsFactors=FALSE)
recovered_ds<-read.csv("time_series_covid19_recovered_global.csv", 
                       header=TRUE, stringsAsFactors=FALSE)

confirmed_sum<-confirmed_ds%>%select(X1.22.20:X5.10.20)%>%summarise_all(sum)
death_sum<-deaths_ds%>%select(X1.22.20:X5.10.20)%>%summarise_all(sum)
recovered_sum<-recovered_ds%>%select(X1.22.20:X5.10.20)%>%summarise_all(sum)


dat <- rbind(confirmed_sum, death_sum, recovered_sum)
dat$dataset <- factor(c(rep("Confirmed", dim(confirmed_sum)[1]), rep("Death", dim(death_sum)[1]), rep("Recovered", dim(recovered_sum)[1])))

data_long <- gather(dat, Dates, SumCases,  X1.22.20:X5.10.20, factor_key=TRUE)


ggplot(data_long, aes(x=Dates, y=SumCases, color=dataset)) + geom_point()+ggtitle("Global Trajectory for COVID-19") + scale_x_discrete(breaks=c("X2.1.20","X3.1.20","X4.1.20", "X5.1.20"),
        labels=c("Feb", "Mar", "Apr", "May"))+labs(y= "Cases", x = "Date")


```

# Global Map
```{r obj2}
library(htmltools)
library(leaflet)
confirmed_ds<-read.csv("time_series_covid19_confirmed_global.csv", 
                       header=TRUE, stringsAsFactors=FALSE)
deaths_ds<-read.csv("time_series_covid19_deaths_global.csv", 
                    header=TRUE, stringsAsFactors=FALSE)
recovered_ds<-read.csv("time_series_covid19_recovered_global.csv", 
                       header=TRUE, stringsAsFactors=FALSE)

confirmed_sum<-confirmed_ds%>%select(Province.State,Country.Region, Lat, Long, X5.10.20)

death_sum<-deaths_ds%>%select(Province.State,Country.Region, Lat, Long, X5.10.20)

recovered_sum<-recovered_ds%>%select(Province.State,Country.Region, Lat, Long, X5.10.20)

head(confirmed_sum)

dat <- rbind(confirmed_sum, death_sum, recovered_sum)
dat$dataset <- factor(c(rep("Confirmed", dim(confirmed_sum)[1]), rep("Death", dim(death_sum)[1]), rep("Recovered", dim(recovered_sum)[1])))

head(dat)

#data_long <- gather(dat, Dates, SumCases,  X1.22.20:X5.10.20, factor_key=TRUE)


# Create a palette that maps factor levels to colors
pal <- colorFactor(c("blue", "cyan", "red"), domain = c("Confirmed", "Death", "Recovered"))

leaflet(dat) %>% addTiles() %>%
  addCircles(
    radius = ~sqrt(dat$X5.10.20)*1000,
    color = ~pal(dataset),
    stroke = TRUE, 
    fillOpacity = 0.4,
    group = ~dataset,
    label = ~htmlEscape(Country.Region), #this needs to change if province/state is available
    popup = ~htmlEscape(X5.10.20) #this needs to say Deaths: and then the number
) %>%
  addLayersControl(
    overlayGroups = c("Confirmed", "Death", "Recovered"),
    options = layersControlOptions(collapsed = FALSE)
  ) 



```

# Narrowing Down Hot Spots
```{r obj3}


```

# Zooming Into Our State
```{r obj4}


```

# Digging Deeper
```{r obj5}


```

